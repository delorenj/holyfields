# generated by datamodel-codegen:
#   filename:  meeting_failed.json
#   timestamp: 2026-01-25T15:24:35+00:00

from __future__ import annotations

from enum import StrEnum
from typing import Literal
from uuid import UUID

from pydantic import AwareDatetime, ConfigDict, Field

from . import comment_extracted
from base_event import BaseEvent


class ErrorType(StrEnum):
    """
    Category of error that caused failure
    """

    agent_error = "agent_error"
    timeout = "timeout"
    network_error = "network_error"
    validation_error = "validation_error"
    internal_error = "internal_error"


class MeetingFailedEvent(BaseEvent):
    """
    Emitted when meeting execution fails. Payload contains error context for debugging.
    """

    model_config = ConfigDict(
        extra="forbid",
    )
    event_type: Literal["meeting.failed"]
    """
    Event type discriminator
    """
    error_type: ErrorType
    """
    Category of error that caused failure
    """
    error_message: str = Field(..., max_length=2000, min_length=1)
    """
    Human-readable error message for debugging
    """
    round_num: comment_extracted.RoundNumber | None = None
    """
    Round number when failure occurred (null if before meeting started)
    """
    agent_name: comment_extracted.AgentName | None = None
    """
    Agent that caused the error (null if not agent-specific)
    """
    timestamp: AwareDatetime
    """
    ISO 8601 UTC timestamp when event was emitted
    """
    meeting_id: UUID = Field(
        ..., pattern="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"
    )
    """
    UUID of the meeting this event relates to. Used for event correlation and tracing.
    """
